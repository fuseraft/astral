#!/usr/bin/astral
/# This ğŸš€ script is for experimentation. #/

def to_bin(number)
  size = 32
  bin_str = [0] * size

  for i in [size - 1..0] do
    bin_str[i] = (number & 1)
    number >>= 1
  end

  return bin_str.join("")
end

def absolute_value(input, res = {})
  mask = input >> (32 * 8 - 1)
  output = (input + mask) ^ mask
  res.bin_input = to_bin(input)
  res.bin_mask = to_bin(mask)
  res.bin_output = to_bin(output)
  res.input = input
  res.output = output
  return output
end

for n in [-5, -408004419, -5009133331,
           5,  408004419,  5009133331] do
  res = {}
  absolute_value(n, res)
  res_list = []

  for key in res do
    res_list << "${key}: ${res[key]}"
  end

  println res_list.join(" ")
end

# output:
/#
bin_input: 11111111111111111111111111111011 bin_mask: 11111111111111111111111111111111 bin_output: 00000000000000000000000000000101 input: -5 output: 5
bin_input: 11100111101011100101100010111101 bin_mask: 11111111111111111111111111111111 bin_output: 00011000010100011010011101000011 input: -408004419 output: 408004419
bin_input: 11010101011011101011000011101101 bin_mask: 11111111111111111111111111111111 bin_output: 00101010100100010100111100010011 input: -5009133331 output: 5009133331
bin_input: 00000000000000000000000000000101 bin_mask: 00000000000000000000000000000000 bin_output: 00000000000000000000000000000101 input: 5 output: 5
bin_input: 00011000010100011010011101000011 bin_mask: 00000000000000000000000000000000 bin_output: 00011000010100011010011101000011 input: 408004419 output: 408004419
bin_input: 00101010100100010100111100010011 bin_mask: 00000000000000000000000000000000 bin_output: 00101010100100010100111100010011 input: 5009133331 output: 5009133331
#/
